# A Deep Learning Approach to Predicting the Number of Jets Generated by a Proton-Proton Collision 

## Intro

Hello, hello! This repository contains the data and code I used to build a model capable of classifying collision events 
based on the number of jets that resulted from the event. This was my first "end-to-end" implementation of a deep learning model, and I am pretty happy with the results. I will include some papers and resources that guided me throughout the project, if you are also interested in 
building something of the sorts, specifically applicable to particle physics. 

## The Data

The dataset I used was released by the CMS collaboration in 2014. It contains part of the data taking on $PP$ events from 2010. Sepecifically, I used the Run B subset of all runs, which equates to 100k or so events. 

The features are: 

1) Run: The run number of the event.
2) Lumi: The lumi section of the event.
3) Event: The event number of the event.
4) MR: First razor kinematic variable
5) Rsq: Second razor kinematic variable
6,7,8,9) E1,Px1,Py1,Pz1: The four-vector of the leading megajet (with the largest transverse momentum).
10,11,12,13) E2,Px2,Py2,Pz2: The four-vector of the subleading megajet (with the largest transverse momentum).
14) HT: The scalar sum of the transverse momentum of the jets.
15) MET: The magnitude of the vector sum of the transverse energy of the particles in the event.
16) nJets: The number of jets with transverse momentum above 40 GeV.
17) nBJets: The number of b-tagged jets with transverse momentum above 40 GeV.

The set was as clean as they come; I didn't need to do any cleaning. I only explored the data and scaled the values when it was time to train the model. I did however add two extra features: P1 and P2, magnitudes of the momenta of the leading and subleading jets.

The full dataset (Run A and Run B) can be found here: CMS Collaboration. (2014). CMS list of validated runs for primary datasets of 2010 data taking. CERN Open Data Portal. DOI: [10.7483/OPENDATA.CMS.YDT4.BW6J](https://doi.org/10.7483/OPENDATA.CMS.YDT4.BW6J)

## Model technicalities, briefly

The final model was built using the Keras functional API. Kept it simple: sequential topology and two kinds of normalization layers, l2 and dropout. I opted for Adam as the optimizer and sparse categorical entropy as the loss function. 

## Some interesting references

As this was my first time swimming in deep [learning] waters (get it?), I first went over a couple of references to acquaint myself with it all (even tho I far from used everything I read about). The following also includes some papers on purely particle physics, as I am no particle physicist (yet!) but still wanted to get a more in-depth explanation on the features of the dataset. My goal in the coming months is to implement a number of these papers, as what they describe really piqued my interest from a technical point of view. Enjoy the read, they're all great texts in my opnion.

ML meet Particle Physics:
- de Oliveira, L., Kagan, M., Mackey, L. et al. Jet-images — deep learning edition. J. High Energ. Phys. 2016, 69 (2016). https://doi.org/10.1007/JHEP07(2016)069
- Lee, J.S.H., Park, I., Watson, I.J. et al. Quark-Gluon Jet Discrimination Using Convolutional Neural Networks. J. Korean Phys. Soc. 74, 219–223 (2019). https://doi.org/10.3938/jkps.74.219
- Komiske, Patrick T., Eric M. Metodiev and Matthew D. Schwartz. “Deep learning in color: towards automated quark/gluon jet discrimination.” Journal of High Energy Physics 2017 (2016): n. pag.
- Albertsson, K. (2021). Machine Learning in High-Energy Physics: Displaced Event Detection and Developments in ROOT/TMVA (PhD dissertation, Luleå University of Technology). Retrieved from https://urn.kb.se/resolve?urn=urn:nbn:se:ltu:diva-87247
- Baldi, P., Sadowski, P. & Whiteson, D. Searching for exotic particles in high-energy physics with deep learning. Nat Commun 5, 4308 (2014). https://doi.org/10.1038/ncomms5308

Purely ML
- Mahesh, Batta. (2019). Machine Learning Algorithms -A Review. 10.21275/ART20203995.
- Deep learning with python. (2017). François Chollet. Manning Publications. 

Purely Particle Physics
- Aad, G., Abbott, B., Abdallah, J., Khalek, S. Abdel, Abdinov, O., Aben, R., Abi, B., Abolins, M., AbouZeid, O. S., Abramowicz, H., Abreu, H., Abreu, R., Abulaiti, Y., Acharya, B. S., Adamczyk, L., Adams, D. L., Adelman, J., Adomeit, S., Adye, T., and et al.. 2014. "Light-quark and gluon jet discrimination in collisions at root s=7 TeV with the ATLAS detector". United States. https://doi.org/10.1140/epjc/s10052-014-3023-z.
-  Rogan, Christopher Sean (2013) Searches for New Symmetries in pp Collisions with the Razor Kinematic Variables at √s = 7 TeV. Dissertation (Ph.D.), California Institute of Technology. doi:10.7907/B0MD-F026. https://resolver.caltech.edu/CaltechTHESIS:05072013-174540453 





